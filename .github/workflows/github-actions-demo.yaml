name: compile
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€
on: [push]
jobs:
  compilemac:
    runs-on: macos-latest
    permissions:
      contents: write
      pull-requests: write
      repository-projects: write

    steps:
      - uses: actions/checkout@v4
      - uses: actions-rust-lang/setup-rust-toolchain@v1
      - run: | 
          rustup install x86_64-apple-darwin
          rustup install aarch64-apple-darwin 
          rustup install x86_64-pc-windows-gnu
          cargo xtask bundle havregryn --target=x86_64-apple-darwin --release
          cd /Users/runner/work/Havregryn/Havregryn/target/bundled/
          zip -r Havregryn_macOS_intel.vst3.zip Havregryn.vst3
      - uses: ncipollo/release-action@v1
        with:
          artifacts: '/Users/runner/work/Havregryn/Havregryn/target/bundled/Havregryn_macOS_intel.vst3.zip' 